{
  "name": "sift-mqtt",
  "display-name": "Sift Mqtt",
  "description": "",
  "author": "",
  "version": "1.0.0",
  "icon": "https://static.redsift.io/assets/sifts/template/blueprint.svg",
  "interfaces": {
    "summary": {
      "controller": "dist/js/controller.umd-es2015.js"
    }
  },
  "dag": {
    "inputs": {
      "webhooks": {
        "mqtt": {
          "inbound": {
            "uri": "{param}",
            "jsonPath": "{ \"key\" : \"$.server.count\", \"value\": { \"param\": \"$.uri.param\" } }"
          }
        }
      }
    },
    "nodes":[{
      "#": "Classify",
      "implementation": {
        "javascript": "server/classify.js"
      },
      "input": {
          "bucket": "mqtt"
      },
      "outputs": {
          "last": {},
          "category": {}         
      }
    },
    {
      "#": "Count",
      "implementation": {
        "javascript": "server/count.js"
      },
      "input": {
          "bucket": "category",
          "select": "/*"
      },
      "outputs": {
          "count": {}         
      }
    }],
    "stores": {
      "category" : {
        "key$schema":"string/string"
      }      
    },
    "outputs":{
      "exports":{
        "count" : {
          "key$schema":"string"
        },
        "last" : {
          "key$schema":"string"
        }        
      }
    }
  }
}
